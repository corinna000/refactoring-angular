<div class="container">
  <div class="jumbotron">
    <h1><i>SlamOff</i></h1>

    <p>The Slam Poetry Bracket App</p>
  </div>
  <div>
    <!--<pre>{{ vm.selectedTracks }}</pre>-->
    <div class="panel panel-default">
      <div class="panel-body">
        <form class="form-inline" ng-submit="vm.searchForPoetry()">
          <div class="form-group">
            <label for="poetrySearch">Search for Slam Poetry</label>
            <input class="form-control" id="poetrySearch" name="poetrySearch" ng-model="vm.model.poetrySearch">
            <button class="btn btn-primary" type="submit">Search</button>
          </div>
        </form>
      </div>
    </div>
    <div id="search-results">
      <div ng-show="!vm.selectedTracks.length"></div>
      <div ng-show="vm.selectedTracks.length > 0 && vm.selectedTracks.length < 8">Select <span
        ng-bind="8 - vm.selectedTracks.length"></span> more tracks</span></div>
      <div ng-show="vm.selectedTracks.length == 8">
        <button class="btn btn-primary" ng-click="vm.startSlamOff()">Start SlamOff!</button>
      </div>
      <div ng-show="vm.selectedTracks.length > 8">You selected too many tracks!</span></div>
      <form name="checkedItems">
        <ul>
          <li ng-repeat="track in vm.searchResults track by $index">
            <label>
              <input type="checkbox" value="{{ $index }}" name="track_{{$index}}" ng-model="track.selected">
              {{ track.title }} ({{ track.duration | date:'mm:ss' }})
            </label>
          </li>
        </ul>
      </form>
    </div>
    <div ng-show="vm.tracks.length">
      <track-player-progress></track-player-progress>
      <table class="table" id="brackets">
        <tr>
          <td class="round-one">
            <h3>Round 1</h3>
            <div ng-hide="vm.getWinner(0)">
              <so-voting-track track="vm.tracks[0]"></so-voting-track>
              vs.
              <so-voting-track track="vm.tracks[1]"></so-voting-track>
            </div>
            <div ng-show="vm.getWinner(0)">
              Winner: <span class="winner">{{ vm.getWinner(0).title }}</span>
            </div>
          </td>
          <td rowdiv="2" class="round-two">

            <h3>Semi-Final</h3>
            <div ng-show="vm.previousRoundsComplete(0) && !vm.getWinner(4)">
              <so-voting-track track="vm.getWinner(0)"></so-voting-track>
              vs.
              <so-voting-track track="vm.getWinner(1)"></so-voting-track>
            </div>
            <div ng-show="vm.getWinner(4)">
              Winner: <span class="winner">{{ vm.getWinner(4).title }}</span>
            </div>

          </td>
          <td rowdiv="4" class="round-three">

            <h3>Final Round</h3>
            <div ng-show="vm.getWinner(4) && vm.getWinner(5)">
              <so-voting-track track="vm.getWinner(4)"></so-voting-track>
              vs.
              <so-voting-track track="vm.getWinner(5)"></so-voting-track>
            </div>
            <div ng-show="vm.getWinner(6)">
              Winner: <span class="winner">{{ vm.getWinner(6).title }}</span>
            </div>
          </td>
        </tr>
        <tr>
          <td class="round-one">
            <div ng-hide="vm.getWinner(1)">
              <so-voting-track track="vm.tracks[2]"></so-voting-track>
              vs.
              <so-voting-track track="vm.tracks[3]"></so-voting-track>
            </div>
            <div ng-show="vm.getWinner(1)">
              Winner: <span class="winner">{{ vm.getWinner(1).title }}</span>
            </div>
        </tr>
        <tr>
          <td class="round-one">
            <div ng-hide="vm.getWinner(2)">
              <so-voting-track track="vm.tracks[4]"></so-voting-track>
              vs.
              <so-voting-track track="vm.tracks[5]"></so-voting-track>
            </div>
            <div ng-show="vm.getWinner(2)">
              Winner: <span class="winner">{{ vm.getWinner(2).title }}</span>
            </div>
          </td>
          <td rowdiv="2" class="round-two">
            <div ng-show="vm.previousRoundsComplete(1) && !vm.getWinner(5)">
              <h3>Semi-Final</h3>
              <so-voting-track track="vm.getWinner(2)"></so-voting-track>
              vs.
              <so-voting-track track="vm.getWinner(3)"></so-voting-track>
            </div>
            <div ng-show="vm.getWinner(5)">
              Winner: <span class="winner">{{ vm.getWinner(5).title }}</span>
            </div>

          </td>
        </tr>
        <tr>
          <td class="round-one">
            <div ng-hide="vm.getWinner(3)">
              <so-voting-track track="vm.tracks[6]"></so-voting-track>
              vs.
              <so-voting-track track="vm.tracks[7]"></so-voting-track>
            </div>
            <div ng-show="vm.getWinner(3)">
              Winner: <span class="winner">{{ vm.getWinner(3).title }}</span>
            </div>
          </td>
        </tr>
      </table>

      <div ng-show="vm.getWinner(6)">
        <h3>Voting Summary:</h3>
        <table class="table table-striped">
          <tr ng-repeat="track in vm.tracks | orderBy: '-votes'">
            <td>{{ track.title }}</td>
            <td><span ng-show="track.votes">{{ track.votes }}</span><span ng-hide="track.votes">0</span></td>
          </tr>

        </table>
      </div>
    </div>
  </div>
</div>
